Arquitectura  de  la  app  Idea  de  la  app   Aplicaci√≥n  m√≥vil  h√≠brida  de  colecci√≥n  y  estrategia  en  tiempo  real.  Combina  la  exploraci√≥n  
f√≠sica
 
(Geolocalizaci√≥n
 
tipo
 
Pok√©mon
 
GO
 
para
 
avistamiento
 
y
 
recolecci√≥n
 
de
 
recursos)
 
con
 
batallas
 
estrat√©gicas
 
de
 
cartas
 
(tipo
 
Magic/Hearthstone)
 
basadas
 
en
 
ornitolog√≠a
 
real.
 
El
 
sistema
 
incluye
 
un
 
Marketplace
 
en
 
tiempo
 
real
 
y
 
funciones
 
sociales
 
avanzadas,
 
soportado
 
por
 
una
 
arquitectura
 
backend
 
Reactiva
 
y
 
No
 
Bloqueante
.
  
C√≥mo  lo  vamos  a  estar  trabajando   Usaremos  el  editor  Antigravity.  En  este  en  los  3  puntos  de  la  zona  del  chat  (arriba)  le  damos  
a
 
habilitar
 
los
 
MCPs.
  
  Un  Mcp  es  una  forma  de  darle  herramientas  externas  y  configuradas  a  la  IA  de  internet  
(hecho
 
por
 
ingenieros
 
de
 
IA)
 
pero
 
en
 
local,
 
de
 
manera
 
que
 
le
 
permite
 
a
 
la
 
IA
 
ser
 
m√°s
 
eficiente
 
a
 
la
 
hora
 
de
 
trabajar
 
(menos
 
tokens).
 
Tambi√©n
 
vamos
 
a
 
usar
 
unas
 
customizaciones,
 
que
 
es
 
como
 
una
 
configuraci√≥n
 
dedicada
 
para
 
el
 
proyecto
 
con
 
un
 
contexto
 
con
 
el
 
que
 
va
 
a
 
estar
 
trabajando
 
el
 
agente
 
puesto.
 
Previamente
 
necesitaremos
 
tener
 instalado  npx  https://nodejs.org/en/download.   MCPs:   -  Supabase  

-  Github   
  Le  damos  a  instalar;  nos  pide  en  algunas  el  token  de  supabase,  donde  se  encuentra  en  el  
perfil
 
de
 
nuestro
 
usuario
 
(suele
 
proporcionarse
 
mediante
 
un
 
link
 
que
 
te
 
sale).
  
 
 

 Customizaciones:  est√°n  en  el  drive.  Se  pone  d√°ndole  a  ‚ÄúGlobal‚Äù  y  metiendo  ah√≠  el  rol  de  
‚Äúcerebro.txt‚Äù.
 
  
Jugabilidad   Va  a  consistir  en  que  fabriquemos  nuestras  cartas  mediante  materiales  (como  si  fueran  
jaulas)
 
con
 
distintos
 
materiales,
 
formas,
 
y
 
tama√±os.
 
Una
 
vez
 
hechas
 
vamos
 
a
 
cazar
 
p√°jaros,
 
cada
 
uno
 
seg√∫n
 
con
 
lo
 
que
 
creemos
 
que
 
pueden
 
atraer
 
al
 
p√°jaro
 
seg√∫n
 
los
 
datos
 
de
 
la
 
vida
 
real
 
(algunos
 
con
 
comida,
 
otros
 
con
 
sonidos,
 
etc‚Ä¶).
  
1.  El  Ciclo  de  Vida  del  Jugador  (UX  Unificada)  El  juego  se  organiza  en  un  ciclo  diario  que  transforma  recursos  f√≠sicos  en  logros  
competitivos:
 
‚óè  Ma√±ana  (Expedici√≥n):  Recolecci√≥n  activa  de  materiales  brutos  (Madera,  Bayas)  
mediante
 
minijuegos
 
de
 
"Enfoque".
 ‚óè  Mediod√≠a  (Crafting):  Construcci√≥n  de  la  Estaci√≥n  de  Reclamo  en  el  Taller  
combinando
 
materiales.
 ‚óè  Tarde  (Notificaci√≥n):  El  sistema  sincroniza  datos  reales  (clima/probabilidad)  y  atrae  
a
 
un
 
ave.
 
Tomas
 
la
 
foto
 
y
 
generas
 
la
 
carta.
 ‚óè  Noche  (Certamen):  Utilizas  tus  nuevas  cartas  en  la  Arena  para  ganar  Reputaci√≥n  y  
materiales
 
de
 
alta
 
calidad
 
(como
 
Metal).
 
2.  Fase  de  Adquisici√≥n:  El  Taller  del  Naturalista  En  lugar  de  comprar  sobres,  el  jugador  construye  la  oportunidad  de  obtener  cartas  
espec√≠ficas
 
mediante
 
la
 
personalizaci√≥n
 
de
 
"Estaciones
 
de
 
Reclamo".
 
A.  Recolecci√≥n  de  Materiales  

Se  obtienen  materiales  mediante  expediciones  pasivas  o  minijuegos  activos:  
‚óè  Madera:  Para  atraer  aves  de  bosque.  ‚óè  Fibras/Hierbas:  Funcionan  como  camuflaje;  sin  ellas,  las  aves  t√≠midas  no  se  
acercar√°n.
 ‚óè  Metal/Restos:  Para  estructuras  urbanas  o  resistentes.  ‚óè  Cebos:  Semillas,  fruta  o  insectos  que  definen  la  probabilidad  de  la  especie.  
B.  Construcci√≥n  y  Sincronizaci√≥n  (Backend  Logic)  El  usuario  dise√±a  la  estaci√≥n  eligiendo  Base  (Madera/Metal),  Tama√±o  (Peque√±a  para  
gorriones,
 
Grande
 
para
 
rapaces)
 
y
 
Cebo
.
 
El
 
servidor
 
calcula
 
qu√©
 
p√°jaro
 
aparece
 
bas√°ndose
 
en:
 
1.  Estructura:  Atrae  familias  espec√≠ficas  (ej.  Madera  $\rightarrow$  P√°jaro  Carpintero).  2.  Cebo:  Define  la  dieta  (ej.  Insectos  $\rightarrow$  Insect√≠voros).  3.  Clima  (API):  Si  llueve,  aumenta  la  probabilidad  de  aves  buscando  refugio.  
Resultado:  Tras  un  tiempo,  la  estaci√≥n  se  gasta  o  pierde  durabilidad,  obligando  
a
 
cerrar
 
el
 
ciclo
 
de
 
consumo
 
y
 
construir
 
una
 
nueva.
 
3.  Fase  de  Batalla:  El  Certamen  ("Magic  Simplificado")  Un  duelo  1vs1  por  turnos  que  utiliza  un  sistema  de  Posturas  y  gesti√≥n  de  energ√≠a.  
El  Tablero  y  Recursos  ‚óè  Zona  de  Juego:  3  huecos  para  p√°jaros  por  jugador.  ‚óè  Mana  (Semillas):  Recurso  que  aumenta  progresivamente  (Turno  1  =  1  Semilla,  
Turno
 
2
 
=
 
2
 
Semillas,
 
etc.)
 
para
 
invocar
 
aves
 
m√°s
 
poderosas.
 ‚óè  Estructura  de  Carta:  Incluye  el  Coste  (Semillas),  Postura  Predilecta  y  Habilidad  
Pasiva
 
(ej.
 
"Si
 
llueve,
 
gana
 
+1
 
en
 
Vuelo").
 
Confrontaci√≥n  y  Duelo  de  Posturas  Si  un  p√°jaro  enfrenta  un  hueco  vac√≠o,  otorga  Puntos  Directos  (Reputaci√≥n) .  Si  enfrenta  a  
otro
 
p√°jaro,
 
se
 
inicia
 
un
 
Duelo
 
de
 
Posturas
 
basado
 
en
 
el
 
Tri√°ngulo
 
de
 
Poder:
 
Postura  Vence  a...  L√≥gica  Narrativa  
Canto  (Rojo)  Plumaje  El  grito  asusta  a  la  belleza.  
Plumaje  (Verde)  Vuelo  La  belleza  distrae  al  movimiento.  
Vuelo  (Azul)  Canto  La  velocidad  escapa  del  ruido.  
Resoluci√≥n  del  Duelo:  
‚óè  Ganas:  El  p√°jaro  rival  huye  (se  elimina  de  la  mesa).  ‚óè  Empatas:  Ambos  se  quedan  "cansados"  en  el  tablero.  ‚óè  Pierdes:  Tu  p√°jaro  se  retira  del  combate.  
4.  Gesti√≥n  y  Progresi√≥n  ‚óè  √Ålbum  (Colecci√≥n):  Las  cartas  tienen  una  Cara  A  (Juego/Stats)  y  una  Cara  B  
(Educativa
 
con
 
datos
 
cient√≠ficos
 
y
 
audio
 
real
 
v√≠a
 
Nuthatch
 
API).
 ‚óè  Marketplace:  Las  cartas  crafteadas  o  repetidas  pueden  venderse  o  subastarse  en  
tiempo
 
real
 
utilizando
 
la
 
arquitectura
 
reactiva
 
del
 
servidor
 
(WebFlux
 
+
 
Redis).
 
Para  completar  el  ecosistema  de  AVIS ,  la  dimensi√≥n  social  act√∫a  como  el  tejido  que  une  la  
exploraci√≥n,
 
el
 
crafteo
 
y
 
el
 
combate,
 
fomentando
 
tanto
 
la
 
competitividad
 
en
 
el
 
mercado
 
como
 
la
 
cooperaci√≥n
 
en
 
el
 
cuidado
 
de
 
las
 
aves.
 
Aqu√≠  tienes  la  integraci√≥n  del  M√≥dulo  Social  con  el  resto  de  la  jugabilidad:  
1.  Bandadas  (Sindicatos  de  Naturalistas)  La  interacci√≥n  principal  se  organiza  a  trav√©s  de  grupos  de  usuarios  llamados  Bandadas .  
‚óè  Chat  en  Tiempo  Real:  Comunicaci√≥n  fluida  mediante  chats  privados  y  de  clan,  
implementados
 
sobre
 
la
 
arquitectura
 
RSocket
 
para
 
garantizar
 
baja
 
latencia.
 ‚óè  Eventos  de  Comunidad:  Participaci√≥n  en  eventos  especiales  que  son  
fundamentales
 
para
 
el
 
progreso
 
del
 
grupo.
 ‚óè  Estrategia  Compartida:  Los  rivales  pueden  ofrecer  consejos  autom√°ticos  tras  las  
batallas;
 
por
 
ejemplo,
 
sugerir
 
buscar
 
especies
 
de
 
monta√±a
 
si
 
detectan
 
debilidades
 
en
 
tu
 
equipo.
 
2.  Marketplace  Reactivo  (Trading)  El  sistema  permite  una  econom√≠a  viva  donde  los  usuarios  no  dependen  del  azar,  sino  del  
intercambio.
 
‚óè  Compra  y  Venta:  Los  usuarios  pueden  vender  cartas  que  han  crafteado  en  el  Taller  
o
 
que
 
tienen
 
repetidas.
 ‚óè  Subastas  en  Tiempo  Real:  Sistema  de  pujas  din√°mico  soportado  por  WebFlux ,  
permitiendo
 
actualizaciones
 
instant√°neas
 
sin
 
recargar
 
la
 
app.
 ‚óè  Seguridad  y  Rapidez:  Uso  de  Redis  para  b√∫squedas  en  submilisegundos  y  
Redisson
 
para
 
evitar
 
que
 
dos
 
personas
 
compren
 
la
 
misma
 
carta
 
simult√°neamente
 
(bloqueos
 
distribuidos).
 
3.  Socializaci√≥n  Cooperativa  y  Mantenimiento  
La  app  premia  activamente  la  interacci√≥n  positiva  entre  los  naturalistas  para  mejorar  la  
experiencia
 
general.
 
‚óè  Mantenimiento  de  Puestos:  Los  puestos  de  avistamiento  tienen  un  tiempo  m√°ximo  
de
 
18
 
horas
 
de
 
efectividad.
 ‚óè  Bonus  por  Ayuda:  Si  un  puesto  ajeno  queda  inhabilitado,  cualquier  usuario  puede  
limpiarlo
 
o
 
mantenerlo,
 
recibiendo
 
a
 
cambio
 
un
 
bonus
 
de
 
recompensa
.
 ‚óè  Santuarios  Visitables:  La  filosof√≠a  de  "Mejorar  tu  Santuario"  se  extiende  a  mostrar  
tus
 
logros
 
y
 
aves
 
raras
 
a
 
otros
 
miembros
 
de
 
tu
 
Bandada.
 
4.  Integraci√≥n  T√©cnica  Social  Para  que  esta  experiencia  sea  fluida,  el  backend  utiliza  herramientas  avanzadas:  
‚óè  Validaci√≥n  de  Identidad:  Spring  Security  Reactive  con  tokens  JWT  asegura  que  
cada
 
transacci√≥n
 
y
 
mensaje
 
sea
 
aut√©ntico
 
y
 
seguro.
 ‚óè  Desacoplamiento  de  Recompensas:  Tras  una  interacci√≥n  social  o  batalla,  un  
gestor
 
de
 
eventos
 
(
RabbitMQ
 
o
 
Kafka
)
 
procesa
 
las
 
recompensas
 
en
 
segundo
 
plano
 
para
 
no
 
interrumpir
 
la
 
navegaci√≥n
 
del
 
usuario.
 ‚óè  Accesibilidad:  Los  botones  sociales  incluyen  etiquetas  descriptivas  (Semantics)  
para
 
que
 
cualquier
 
persona,
 
independientemente
 
de
 
su
 
nivel
 
t√©cnico,
 
pueda
 
interactuar
 
con
 
la
 
comunidad.
 
 
Frontend   -  Funcionalidad  simple  para  que  cualquier  persona  entienda  bien  ell  funcionamiento  de  la  
aplicaci√≥n
 
da
 
igual
 
la
 
edad
 
y
 
el
 
nivel
 
t√©cnico.
  Tecnolog√≠as :   -  React  Native  
 
 BORRADOR  
GU√çA  DE  ESTILO  Y  UX  (Design  System)  
Antes  de  pintar  pantallas,  definimos  las  reglas  visuales.  
1.  La  Met√°fora  Visual:  "El  Cuaderno  de  Campo  Vivo"  
La  aplicaci√≥n  debe  sentirse  como  si  tuvieras  un  diario  de  naturalista  en  las  manos,  
pero
 
m√°gico.
 
‚óè  Paleta  de  Colores  (Naturaleza  Soft):  
‚óã  Primario:  Verde  Salvia  (#7C9A92)  -  Para  acciones  principales.  ‚óã  Secundario:  Terracota  Suave  (#D9A08B)  -  Para  alertas  o  combate.  ‚óã  Fondo:  Papel  Crema/Hueso  (#FDFBF7)  -  Evita  el  blanco  puro,  cansa  la  
vista.
 ‚óã  Texto:  Gris  Carb√≥n  (#2C3E50)  -  Alto  contraste  pero  menos  agresivo  que  
el
 
negro.
 ‚óè  Tipograf√≠a:  ‚óã  T√≠tulos:  Merriweather  o  Lora  (Serif).  Elegancia  cl√°sica.  ‚óã  Cuerpo/Botones:  Nunito  o  Quicksand  (Sans  Serif  redondeada).  Muy  
amigable
 
y
 
legible.
 ‚óè  Formas:  ‚óã  Glassmorphism:  Paneles  semitransparentes  con  desenfoque  (blur)  
para
 
superponer
 
men√∫s
 
sobre
 
los
 
fondos
 
de
 
naturaleza.
 ‚óã  Bordes:  Todo  muy  redondeado  (border-radius:  20px).  Nada  de  
esquinas
 
afiladas.
 
 
üì±  ESQUEMA  DE  PANTALLAS  
(WIREFRAMES
 
&
 
FLUJO)
 
La  navegaci√≥n  se  basa  en  una  Barra  Inferior  (Bottom  Bar)  persistente  con  4  iconos  
grandes.
 
1.  PANTALLA:  EL  SANTUARIO  (HOME)  
Objetivo:  Relajaci√≥n  y  estado  general.  
‚óè  Fondo  (Din√°mico):  ‚óã  Ocupa  toda  la  pantalla.  Es  una  ilustraci√≥n  vectorial  (SVG)  o  Lottie  que  
cambia
 
seg√∫n
 
la
 
API
 
del
 
tiempo
 
(Lluvia,
 
Sol,
 
Noche).
 ‚óè  Zona  Central  (El  √Årbol):  ‚óã  Un  √°rbol  ilustrado  donde  se  posan  aleatoriamente  3-5  p√°jaros  de  tu  
colecci√≥n.
 ‚óã  Interacci√≥n:  Si  tocas  un  p√°jaro,  hace  su  sonido  (Audio)  y  suelta  una  
peque√±a
 
animaci√≥n
 
de
 
corazones.
 ‚óè  Panel  Superior  (Resumen):  ‚óã  Peque√±a  tarjeta  de  cristal:  " üå§  Madrid:  Despejado  |  üå°  18¬∫C".  ‚óã  Contador  de  recursos:  " üå∞  Semillas:  150".  
2.  PANTALLA:  EXPEDICI√ìN  (Juego  Pasivo/Activo)  
Objetivo:  Conseguir  "Fotos"  (Material  base).  
‚óè  Selector  de  Bioma  (Carrusel):  ‚óã  Deslizar  izquierda/derecha  para  elegir:  Bosque,  Costa,  Monta√±a.  ‚óã  Indicador  Visual:  Si  llueve  en  el  juego,  el  icono  del  Bosque  tiene  gotitas.  ‚óè  Estado  A:  Iniciar  Expedici√≥n  ‚óã  Bot√≥n  grande  "Enviar  Observador".  ‚óã  Selector  de  Cebo  (Iconos  grandes:  Gusano,  Fruta,  Pez).  ‚óè  Estado  B:  Esperando  (El  Minijuego)  ‚óã  Mientras  corre  el  tiempo  (ej:  01:59:00),  aparece  un  bot√≥n  vibrante:  
"Realizar
 
Avistamiento
 
R√°pido".
 ‚óã  Overlay  del  Minijuego  "Enfoque":  ‚ñ†  Fondo:  Una  foto  de  Pexels  muy  borrosa.  ‚ñ†  Control:  Un  slider  horizontal  en  la  parte  baja.  ‚ñ†  Acci√≥n:  Mover  el  slider  hasta  que  la  foto  est√©  n√≠tida.  Al  soltar  en  
el
 
punto
 
exacto
 
->
 
¬°Flash!
 
->
 
Ganas
 
"Notas
 
de
 
Campo".
 
3.  PANTALLA:  TALLER  (CRAFTING)  
Objetivo:  Crear  las  cartas  finales.  
‚óè  Dise√±o:  Parece  una  mesa  de  madera  de  escritorio.  ‚óè  Zona  de  Drop  (El  Tapete):  ‚óã  Tres  huecos  vac√≠os  con  formas:  [Foto]  +  [Pluma]  +  [Notas].  ‚óè  Inventario  Inferior:  ‚óã  Lista  horizontal  arrastrable  con  tus  objetos  conseguidos  en  
expediciones.
 ‚óè  Feedback:  ‚óã  Al  arrastrar  los  3  objetos  correctos,  el  centro  brilla.  ‚óã  Bot√≥n  "Registrar  Ave"  se  activa.  ‚óã  Animaci√≥n  de  Recompensa:  La  carta  aparece  en  blanco,  se  dibuja  el  
contorno
 
y
 
luego
 
se
 
rellena
 
de
 
color
 
(efecto
 
acuarela).
 
4.  PANTALLA:  CERTAMEN  (BATALLA)  
Objetivo:  Competir  (Piedra-Papel-Tijera  Estrat√©gico).  
‚óè  Layout  Dividido:  ‚óã  Arriba:  P√°jaro  del  Rival  (Avatar  +  Nombre).  ‚óã  Abajo:  Tu  P√°jaro  (Avatar  +  Stats).  ‚óè  Zona  Central  (La  Acci√≥n):  ‚óã  3  Botones  Circulares  Grandes  (Iconos):  1.  üé§  Canto  (Rojo)  2.  üí®  Vuelo  (Azul)  3.  ü™∂  Plumaje  (Verde)  ‚óè  Indicadores  de  Ayuda  (Accesibilidad):  ‚óã  Flechas  peque√±as  entre  los  botones  que  indican  qui√©n  gana  a  qui√©n  
(Canto
 
>
 
Plumaje).
 ‚óè  El  Factor  Clima:  
‚óã  Si  hay  VIENTO  (API),  el  bot√≥n  de  Vuelo  tiene  un  icono  de  "Prohibido"  o  
un
 
candado
 
semitransparente
 
que
 
indica
 
"Cuesta
 
m√°s
 
energ√≠a".
 
5.  PANTALLA:  EL  √ÅLBUM  (COLECCI√ìN)  
Objetivo:  Gesti√≥n  y  Consulta.  
‚óè  Vista  de  Rejilla:  Cards  rectangulares  verticales.  ‚óè  Filtros:  Pesta√±as  simples:  "Todos",  "Agua",  "Bosque".  ‚óè  Detalle  de  Carta  (Modal  a  pantalla  completa):  ‚óã  Cara  A  (Juego):  Foto  grande,  Nombre  Com√∫n,  Iconos  de  Stats  (1-10).  ‚óã  Bot√≥n  Girar:  Icono  de  flecha  en  la  esquina.  ‚óã  Cara  B  (Educativa):  Fondo  estilo  papel  antiguo.  Nombre  cient√≠fico,  Mapa  
de
 
distribuci√≥n,
 
Texto
 
de
 
curiosidad,
 
Bot√≥n
 
de
 
"Escuchar
 
Canto".
 
 
üõ†  COMPONENTES  T√âCNICOS  
(FLUTTER/REACT)
 
Para  programar  esto  ordenadamente  en  el  Frontend:  
A.  Widgets  Reutilizables  (Components)  
1.  WeatherBackground:  Un  componente  que  recibe  el  estado  del  clima  ("RAIN",  
"SUN")
 
y
 
renderiza
 
el
 
fondo
 
animado
 
correspondiente.
 2.  BirdCard:  El  componente  visual  de  la  carta.  Debe  aceptar  par√°metros  para  
mostrarse
 
en
 
"Modo
 
Mini"
 
(Inventario)
 
o
 
"Modo
 
Full"
 
(√Ålbum).
 3.  ResourceCounter:  Pill  (pastilla)  visual  con  icono  y  n√∫mero  animado.  
B.  Gesti√≥n  de  Estado  (Logic)  
Necesitamos  un  gestor  de  estado  global  (Provider,  Bloc  o  Riverpod  en  Flutter).  
‚óè  WeatherProvider:  Consulta  a  tu  Backend  al  abrir  la  app  y  guarda  el  clima.  
Todos
 
los
 
componentes
 
se
 
suscriben
 
a
 
esto
 
para
 
saber
 
si
 
"llueve".
 ‚óè  UserProvider:  Guarda  las  monedas  (Semillas,  Notas)  y  el  Inventario.  
C.  Accesibilidad  (El  Toque  Profesional)  
‚óè  Semantics  (Flutter):  Etiquetar  cada  bot√≥n  para  lectores  de  pantalla.  ‚óã  Mal:  Bot√≥n  con  icono  de  micr√≥fono.  ‚óã  Bien:  Etiqueta  "Usar  Canto.  Fuerte  contra  Plumaje".  ‚óè  Haptic  Feedback:  Vibraci√≥n  suave  del  m√≥vil  cuando:  
‚óã  Enfocas  bien  la  foto  en  el  minijuego.  ‚óã  Ganas  una  ronda  en  el  Certamen.  
 
üí°  DETALLE  DE  "JUGABILIDAD  
INTERCONECTADA"
 
EN
 
LA
 
UI
 
¬øC√≥mo  le  mostramos  al  usuario  que  todo  est√°  conectado?  Con  Pistas  Visuales.  
1.  En  la  Expedici√≥n:  ‚óã  Si  tienes  "Notas  de  Campo"  (conseguidas  en  el  minijuego),  el  bot√≥n  de  
"Enviar
 
Expedici√≥n"
 
brilla
 
en
 
dorado,
 
indicando
 
que
 
tendr√°s
 
m√°s
 
suerte.
 2.  En  el  Taller:  ‚óã  Si  te  falta  una  "Pluma"  para  completar  un  p√°jaro,  al  pulsar  el  hueco  
vac√≠o,
 
sale
 
un
 
popup:
 
"¬°Gana
 
cert√°menes
 
para
 
conseguir
 
plumas!"
.
 
(Te
 
redirige
 
al
 
juego).
 3.  En  el  Certamen:  ‚óã  Si  pierdes  una  batalla,  el  rival  te  dice:  "Tu  p√°jaro  es  lento.  Busca  
especies
 
de
 
Monta√±a
 
en
 
las
 
Expediciones"
.
 
 
 
TERMINA
 
BORRADOR
 
 
  
Backend   APIS  RECOMENDADAS  POR  EL  PROFE    
APIs
 
√∫tiles
 
para
 
el
 
proyecto
 
de
 
DAM
 Unsplash  API  y  Pexels  API  son  opciones  populares  para  descargar  fotos  gratuitas  de  alta  calidad  mediante  solicitudes  program√°ticas.  Unsplash  API  Proporciona  acceso  a  millones  de  im√°genes  gratuitas  para  uso  comercial  sin  atribuci√≥n  obligatoria.  Reg√≠strate  en  unsplash.com/developers  para  obtener  una  clave  API  gratuita,  con  l√≠mites  iniciales  de  50  solicitudes  por  hora  (ampliables).  Usa  endpoints  como  /photos/random  para  fotos  aleatorias  o  /search/photos  para  b√∫squedas  espec√≠ficas.  Pexels  API  Ofrece  fotos  y  videos  gratuitos  con  licencia  CC0,  ideal  para  proyectos  web.  Crea  una  cuenta  en  pexels.com/api  para  tu  clave  API  gratuita  (200  solicitudes  por  hora,  20,000  mensuales).  Endpoints  clave  incluyen  /v1/photos/popular  y  /v1/search  para  curaci√≥n  y  b√∫squedas.  Otras  alternativas  simples  
Lorem  Picsum:  API  sin  registro  para  im√°genes  placeholder  aleatorias  (ej.  https://picsum.photos/800/600),  perfecta  para  pruebas  r√°pidas  sin  l√≠mites  estrictos.  Pixabay  API:  Miles  de  fotos  gratuitas  con  clave  gratuita,  soporta  b√∫squedas  por  categor√≠a  y  alta  resoluci√≥n.  Nuthatch  API  ‚Äî  Es  una  API  gratuita  orientada  a  aves;  su  cat√°logo  incluye  fotos  (compiladas  con  im√°genes  de  fuentes  libres  como  Unsplash  +  contribuciones  privadas).  Vecteezy  API  ‚Äî  Permite  acceder  a  una  biblioteca  enorme  de  fotos,  vectores  y  recursos  gr√°ficos;  √∫til  si  no  necesitas  fotos  espec√≠ficamente  ornitol√≥gicas,  pero  s√≠  im√°genes  "libres"  de  aves  o  naturaleza.   
APIs  Externas  (Gesti√≥n  de  Recursos)  
‚óè  Nuthatch  API:  Fuente  de  verdad  para  datos  taxon√≥micos  (nombre  cient√≠fico,  
familia).
 ‚óè  Unsplash  /  Pexels  API:  Fondos  de  cartas  (h√°bitats)  y  eventos.  ‚óè  Vecteezy:  Iconograf√≠a  vectorial  para  la  UI  (plumas,  nidos,  ataque).  
 
Alojamiento  de  Datos   Supabase  con  JSON  SQLite  en  local   
Manejo  de  Datos  (Java  +  Spring  Framework)   Se  centrar√°  en  usar  Java  +  Spring  para  el  manejo  de  los  datos  y  la  informaci√≥n.  
Aqu√≠  tienes  el  diagrama  conceptual  de  lo  que  vamos  a  construir,  seguido  de  la  tabla  
definitiva
 
que
 
resume
 
tu
 
Stack
 
Reactivo
 
y
 
As√≠ncrono
.
 
El  Stack  100%  As√≠ncrono  (WebFlux  /  Reactor)  
M√≥dulo  /  Tecnolog√≠a  ¬øPor  qu√©  lo  usamos?  (La  Ventaja)  ¬øC√≥mo  se  implementa?  (La  Pr√°ctica)  
Spring  WebFlux   (Servidor  Netty)  
Es  el  motor  central  no  bloqueante.  Permite  que  un  solo  servidor  maneje  miles  de  partidas  a  la  vez  sin  quedarse  sin  memoria  RAM.  
Se  usa  en  lugar  de  Spring  MVC  (Tomcat).  En  tu  c√≥digo  Java,  en  vez  de  devolver  Carta,  devuelves  Mono<Carta> o  Flux<Carta>.  
RSocket   (Comunicaci√≥n)  
Protocolo  bidireccional  m√°s  r√°pido  que  WebSockets.  Soporta  Backpressure :  si  el  m√≥vil  va  lento,  ajusta  el  env√≠o  de  datos  para  no  colgar  la  app  React.  
Se  habilita  con  spring-boot-starter-rsocket.  Usas  la  anotaci√≥n  @MessageMapping para  escuchar  los  movimientos  (ej:  "Atacar")  del  cliente.  
Spring  Data  R2DBC   (Conexi√≥n  DB)  
Es  el  driver  as√≠ncrono  para  PostgreSQL  (Supabase).  Evita  que  el  servidor  se  quede  "congelado"  
Reemplaza  a  Hibernate/JPA.  Creas  repositorios  reactivos  (ReactiveCrudRepository)  que  devuelven  Mono/Flux al  interactuar  con  las  tablas.  
esperando  a  que  la  base  de  datos  lea  el  inventario.  
Jackson  +  R2DBC  Converters   (Mapeo  JSON)  
R2DBC  es  "crudo"  y  no  entiende  el  tipo  JSONB de  Postgres  m√°gicamente.  Jackson  traduce  ese  JSON  a  objetos  Java  al  vuelo.  
Creas  una  clase  que  implemente  Converter<Json,  MiCartaRecord> y  usas  ObjectMapper de  Jackson  para  deserializar  el  string  JSONB  de  Supabase.  
Spring  Data  Redis  Reactive   (Cach√©  Marketplace)  
Para  el  Marketplace,  consultar  Supabase  por  cada  b√∫squeda  saturar√≠a  la  red.  Redis  mantiene  el  cat√°logo  en  RAM  para  respuestas  en  submilisegundos.  
Usas  ReactiveRedisTemplate para  guardar  y  leer  las  ofertas  activas  sin  bloquear  el  hilo  principal.  
Redisson   (Distributed  Locks)  
Evita  el  "doble  gasto"  o  clonaci√≥n  de  cartas  en  el  Marketplace.  Bloquea  una  carta  a  nivel  de  red  entera  si  dos  personas  la  compran  a  la  vez.  
Cuando  un  usuario  le  da  a  "Comprar",  pides  un  lock  (RLockReactive)  a  Redisson  por  el  ID  de  la  carta.  Nadie  m√°s  puede  tocarla  hasta  que  se  libere.  
Spring  Security  Reactive   (Auth)  
Valida  que  el  usuario  sea  quien  dice  ser  sin  frenar  el  flujo  de  datos.  Se  integra  directamente  con  el  sistema  Auth  de  Supabase.  
Configuras  un  ReactiveJwtDecoder que  verifica  la  firma  del  token  enviado  desde  la  WebView  y  guarda  el  usuario  en  el  ReactiveSecurityContext.  
Spring  Kafka  o  RabbitMQ   (Event  Broker)  
Saca  el  trabajo  pesado  fuera  de  la  partida.  (Ej:  Repartir  experiencia,  guardar  logs,  dar  recompensas  al  acabar  un  duelo).  
Al  acabar  la  partida,  emites  un  evento  PartidaTerminada.  El  hilo  del  jugador  queda  libre  al  instante,  y  otro  microservicio  procesa  las  recompensas.   
Las  Alternativas  (El  "Plan  B")  Si  durante  el  desarrollo  veis  que  el  modelo  reactivo  (Mono /  Flux)  hace  que  el  c√≥digo  sea  
muy
 
dif√≠cil
 
de
 
leer
 
o
 
testear,
 
estas
 
son
 
las
 
alternativas
 
que
 
sacrifican
 
un
 
poco
 
de
 
rendimiento
 
puro
 
por
 
facilidad
 
de
 
desarrollo
:
 
‚óè  Alternativa  a  WebFlux  (Motor):  Spring  Web  MVC  +  Virtual  Threads  (Java  21+).  ‚óã  Por  qu√©:  Te  permite  escribir  c√≥digo  tradicional  paso  a  paso  (s√≠ncrono  y  f√°cil  
de
 
leer)
 
pero
 
con
 
casi
 
el
 
mismo
 
rendimiento
 
masivo
 
que
 
WebFlux
 
gracias
 
a
 
los
 
hilos
 
virtuales
 
de
 
Java.
 ‚óè  Alternativa  a  RSocket  (Comunicaci√≥n):  WebSockets  Cl√°sicos  (STOMP).  ‚óã  Por  qu√©:  Es  mucho  m√°s  f√°cil  de  integrar  con  React  y  la  WebView.  Hay  
decenas
 
de
 
librer√≠as
 
listas
 
para
 
usar
 
(como
 sockjs-client),  mientras  que  
RSocket
 
requiere
 
un
 
poco
 
m√°s
 
de
 
configuraci√≥n
 
en
 
el
 
frontend.
 ‚óè  Alternativa  a  R2DBC  (Base  de  datos):  Spring  Data  JPA  (Hibernate)  +  
Hypersistence
 
Utils.
 ‚óã  Por  qu√©:  R2DBC  requiere  que  hagas  t√∫  mismo  el  mapeo  de  relaciones  y  
JSONB.
 
JPA/Hibernate
 
te
 
hace
 
toda
 
la
 
"magia"
 
de
 
convertir
 
las
 
tablas
 
y
 
el
 
JSON
 
de
 
Supabase
 
en
 
objetos
 
Java
 
con
 
simples
 
anotaciones,
 
a
 
costa
 
de
 
usar
 
operaciones
 
bloqueantes.
 
‚óè  Alternativa  a  Kafka/Redis  (Mercado  simple):  Optimistic  Locking  en  
PostgreSQL.
 ‚óã  Por  qu√©:  Si  no  quieres  pagar/mantener  servidores  extra  de  Redis  o  Kafka,  
puedes
 
usar
 
un
 
simple
 
campo
 @Version en  Supabase.  Si  hay  un  conflicto  de  
compra,
 
la
 
base
 
de
 
datos
 
lanza
 
una
 
excepci√≥n,
 
se
 
cancela
 
todo,
 
y
 
le
 
muestras
 
un
 
error
 
de
 
"Carta
 
ya
 
vendida"
 
al
 
usuario.
 
Backend  (Lo  que  usaremos)  
‚óè  Framework  Core:  Spring  Boot  3  (WebFlux).  ‚óè  Motor  As√≠ncrono:  Project  Reactor  (Mono/Flux).  ‚óè  Comunicaci√≥n  Cliente-Servidor:  RSocket  (para  el  juego  en  tiempo  real)  +  REST  
(para
 
configuraci√≥n
 
inicial).
 ‚óè  Persistencia:  Spring  Data  R2DBC  (Reactivo).  ‚óè  Base  de  Datos:  Supabase  (PostgreSQL) .  Uso  intensivo  de  tipos  JSONB para  las  
cartas
 
y
 PostGIS (si  Supabase  lo  permite,  o  coordenadas  simples)  para  la  
geolocalizaci√≥n.
 ‚óè  Cach√©  &  Locks:  Redis  Reactive  (con  Redisson  para  bloqueos  distribuidos  en  el  
Marketplace).
 ‚óè  Event  Broker:  RabbitMQ  o  Kafka  (para  desacoplar  la  l√≥gica  de  recompensas  
post-partida).
 ‚óè  Seguridad:  Spring  Security  Reactive  +  JWT  (validando  contra  Supabase  Auth).  
Implementaci√≥n  en  el  server  
Comandos  Server:  
    2   sudo  apt  update  &&  sudo  apt  upgrade  -y  
    3   sudo  apt  install  python-is-python3  -y  
    4   sudo  apt  install  python3  python3-pip  python3-venv  -y  
    5   python3  --version  
    6   pip3  --version  
    7   sudo  apt  install  curl  -y  
    8   curl  -o-  https://raw.githubusercontent.com/nvm-sh/nvm/v0.40.1/install.sh  |  bash  
    9   source  ~/.bashrc  
   10   nvm  install  node  
   11   sudo  apt  install  openjdk-21-jdk  -y  
   12   sudo  apt  install  docker.io  docker-compose  -y  
   13   sudo  usermod  -aG  docker  $USER  
   14   sudo  usermod  -aG  docker  $lubuntu  
   15   sudo  apt  install  maven  -y  
 
 